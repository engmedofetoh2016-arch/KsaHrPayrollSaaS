<div class="shell">
  <aside [class.open]="isMobileNavOpen">
    <div class="brand">{{ i18n.text('KSA HR Payroll', 'إدارة الموارد البشرية') }}</div>
    <nav>
      <a routerLink="/dashboard" routerLinkActive="active" (click)="closeMobileNav()">{{ i18n.text('Dashboard', 'لوحة التحكم') }}</a>
      @if (canAccessCompliance()) {
        <a routerLink="/compliance" routerLinkActive="active" (click)="closeMobileNav()">{{ i18n.text('Compliance Center', 'مركز الالتزام') }}</a>
      }
      @if (canAccessSmartAlerts()) {
        <a routerLink="/smart-alerts" routerLinkActive="active" (click)="closeMobileNav()">{{ i18n.text('Smart Alerts', 'التنبيهات الذكية') }}</a>
      }
      @if (canAccessCompany()) {
        <a routerLink="/company" routerLinkActive="active" (click)="closeMobileNav()">{{ i18n.text('Company', 'الشركة') }}</a>
      }
      @if (canAccessEmployees()) {
        <a routerLink="/employees" routerLinkActive="active" (click)="closeMobileNav()">{{ i18n.text('Employees', 'الموظفون') }}</a>
      }
      @if (canAccessFinalSettlement()) {
        <a routerLink="/final-settlement" routerLinkActive="active" (click)="closeMobileNav()">{{ i18n.text('Final Settlement', 'التسوية النهائية') }}</a>
      }
      @if (canAccessLoans()) {
        <a routerLink="/loans" routerLinkActive="active" (click)="closeMobileNav()">{{ i18n.text('Loans & Advances', 'السلف والقروض') }}</a>
      }
      @if (canAccessOffboarding()) {
        <a routerLink="/offboarding" routerLinkActive="active" (click)="closeMobileNav()">{{ i18n.text('Offboarding Checklist', 'قائمة إنهاء الخدمة') }}</a>
      }
      <a routerLink="/leave/my" routerLinkActive="active" (click)="closeMobileNav()">{{ i18n.text('My Leave', 'إجازاتي') }}</a>
      @if (isEmployee()) {
        <a routerLink="/employee/profile" routerLinkActive="active" (click)="closeMobileNav()">{{ i18n.text('My Profile', 'ملفي الشخصي') }}</a>
        <a routerLink="/employee/payslips" routerLinkActive="active" (click)="closeMobileNav()">{{ i18n.text('My Payslips', 'قسائم رواتبي') }}</a>
        <a routerLink="/employee/salary-certificate" routerLinkActive="active" (click)="closeMobileNav()">{{ i18n.text('Salary Certificate', 'شهادة الراتب') }}</a>
        <a routerLink="/employee/eos-estimate" routerLinkActive="active" (click)="closeMobileNav()">{{ i18n.text('EOS Estimate', 'تقدير نهاية الخدمة') }}</a>
      }
      @if (canApproveLeave()) {
        <a routerLink="/leave/approvals" routerLinkActive="active" (click)="closeMobileNav()">{{ i18n.text('Leave Approvals', 'موافقات الإجازات') }}</a>
      }
      @if (canAccessAttendance()) {
        <a routerLink="/attendance" routerLinkActive="active" (click)="closeMobileNav()">{{ i18n.text('Attendance', 'الحضور') }}</a>
      }
      @if (canAccessPayroll()) {
        <a routerLink="/payroll" routerLinkActive="active" (click)="closeMobileNav()">{{ i18n.text('Payroll', 'الرواتب') }}</a>
        <a routerLink="/operations-studio" routerLinkActive="active" (click)="closeMobileNav()">{{ i18n.text('Operations Studio', 'استوديو العمليات') }}</a>
      }
      @if (canAccessGovernanceRegistry()) {
        <a routerLink="/governance/references" routerLinkActive="active" (click)="closeMobileNav()">{{ i18n.text('Reference Registry', 'سجل المراجع') }}</a>
      }
      @if (canManageUsers()) {
        <a routerLink="/users" routerLinkActive="active" (click)="closeMobileNav()">{{ i18n.text('Users', 'المستخدمون') }}</a>
      }
    </nav>
  </aside>

  @if (isMobileNavOpen) {
    <button class="overlay" type="button" (click)="closeMobileNav()" aria-label="Close menu"></button>
  }

  <main>
    <header>
      <button class="menu-toggle" type="button" (click)="toggleMobileNav()" aria-label="Open menu">{{ i18n.text('Menu', 'القائمة') }}</button>
      <div>
        <strong>{{ session()?.firstName }} {{ session()?.lastName }}</strong>
        <span>{{ session()?.email }}</span>
      </div>
      <div class="header-actions">
        <button type="button" class="lang" routerLink="/change-password">{{ i18n.text('Password', 'كلمة المرور') }}</button>
        <button type="button" class="lang" (click)="i18n.toggleLanguage()">
          {{ i18n.isArabic() ? 'EN' : 'AR' }}
        </button>
        <button (click)="logout()">{{ i18n.text('Logout', 'تسجيل الخروج') }}</button>
      </div>
    </header>

    <section class="content">
      <router-outlet />
    </section>
  </main>
</div>
