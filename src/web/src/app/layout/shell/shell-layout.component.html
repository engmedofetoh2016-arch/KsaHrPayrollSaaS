<div class="shell">
  <aside [class.open]="isMobileNavOpen">
    <div class="brand">{{ i18n.text('KSA HR Payroll', 'KSA HR Payroll') }}</div>
    <nav>
      <a routerLink="/dashboard" routerLinkActive="active" (click)="closeMobileNav()">{{ i18n.text('Dashboard', 'Dashboard') }}</a>
      @if (canAccessCompliance()) {
        <a routerLink="/compliance" routerLinkActive="active" (click)="closeMobileNav()">{{ i18n.text('Compliance Center', 'Compliance Center') }}</a>
      }
      @if (canAccessCompany()) {
        <a routerLink="/company" routerLinkActive="active" (click)="closeMobileNav()">{{ i18n.text('Company', 'Company') }}</a>
      }
      @if (canAccessEmployees()) {
        <a routerLink="/employees" routerLinkActive="active" (click)="closeMobileNav()">{{ i18n.text('Employees', 'Employees') }}</a>
      }
      @if (canAccessFinalSettlement()) {
        <a routerLink="/final-settlement" routerLinkActive="active" (click)="closeMobileNav()">{{ i18n.text('Final Settlement', 'Final Settlement') }}</a>
      }
      <a routerLink="/leave/my" routerLinkActive="active" (click)="closeMobileNav()">{{ i18n.text('My Leave', 'My Leave') }}</a>
      @if (isEmployee()) {
        <a routerLink="/employee/profile" routerLinkActive="active" (click)="closeMobileNav()">{{ i18n.text('My Profile', 'My Profile') }}</a>
        <a routerLink="/employee/payslips" routerLinkActive="active" (click)="closeMobileNav()">{{ i18n.text('My Payslips', 'My Payslips') }}</a>
      }
      @if (canApproveLeave()) {
        <a routerLink="/leave/approvals" routerLinkActive="active" (click)="closeMobileNav()">{{ i18n.text('Leave Approvals', 'Leave Approvals') }}</a>
      }
      @if (canAccessAttendance()) {
        <a routerLink="/attendance" routerLinkActive="active" (click)="closeMobileNav()">{{ i18n.text('Attendance', 'Attendance') }}</a>
      }
      @if (canAccessPayroll()) {
        <a routerLink="/payroll" routerLinkActive="active" (click)="closeMobileNav()">{{ i18n.text('Payroll', 'Payroll') }}</a>
      }
      @if (canManageUsers()) {
        <a routerLink="/users" routerLinkActive="active" (click)="closeMobileNav()">{{ i18n.text('Users', 'Users') }}</a>
      }
    </nav>
  </aside>

  @if (isMobileNavOpen) {
    <button class="overlay" type="button" (click)="closeMobileNav()" aria-label="Close menu"></button>
  }

  <main>
    <header>
      <button class="menu-toggle" type="button" (click)="toggleMobileNav()" aria-label="Open menu">Menu</button>
      <div>
        <strong>{{ session()?.firstName }} {{ session()?.lastName }}</strong>
        <span>{{ session()?.email }}</span>
      </div>
      <div class="header-actions">
        <button type="button" class="lang" (click)="i18n.toggleLanguage()">
          {{ i18n.isArabic() ? 'EN' : 'AR' }}
        </button>
        <button (click)="logout()">{{ i18n.text('Logout', 'Logout') }}</button>
      </div>
    </header>

    <section class="content">
      <router-outlet />
    </section>
  </main>
</div>
