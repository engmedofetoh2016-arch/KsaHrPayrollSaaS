<section class="panel">
  <h2>Leave Approvals</h2>

  <div class="actions">
    <button type="button" [class.active]="statusFilter() === 1" (click)="setStatusFilter(1)">Pending</button>
    <button type="button" [class.active]="statusFilter() === 2" (click)="setStatusFilter(2)">Approved</button>
    <button type="button" [class.active]="statusFilter() === 3" (click)="setStatusFilter(3)">Rejected</button>
    <button type="button" [class.active]="statusFilter() === 0" (click)="setStatusFilter(0)">All</button>
  </div>

  @if (message()) { <p class="ok">{{ message() }}</p> }
  @if (error()) { <p class="error">{{ error() }}</p> }

  <table>
    <thead>
      <tr>
        <th>Employee</th>
        <th>Type</th>
        <th>Start</th>
        <th>End</th>
        <th>Days</th>
        <th>Status</th>
        <th>Reason</th>
        <th>Actions</th>
      </tr>
    </thead>
    <tbody>
      @for (request of requests(); track request.id) {
        <tr>
          <td>{{ request.employeeName }}</td>
          <td>{{ leaveTypeLabel(request.leaveType) }}</td>
          <td>{{ request.startDate }}</td>
          <td>{{ request.endDate }}</td>
          <td>{{ request.totalDays | number: '1.0-2' }}</td>
          <td>{{ statusLabel(request.status) }}</td>
          <td>
            {{ request.reason }}
            @if (request.status === 3 && request.rejectionReason) {
              <div class="reject">Rejected: {{ request.rejectionReason }}</div>
            } @else if (request.status === 2 && request.rejectionReason) {
              <div class="reject">Review Comment: {{ request.rejectionReason }}</div>
            }
          </td>
          <td>
            @if (request.status === 1) {
              <div class="row-actions">
                <button type="button" (click)="approve(request.id)" [disabled]="busy()">Approve</button>
                <button type="button" (click)="reject(request.id)" [disabled]="busy()">Reject</button>
              </div>
            } @else {
              <span>-</span>
            }
          </td>
        </tr>
      }
    </tbody>
  </table>
</section>
